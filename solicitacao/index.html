<!DOCTYPE html>
<!-- saved from url=(0041)https://gov.portal.anvisa.org/solicitacao -->
<html lang="pt-br"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <title>Solicitação de Medicamento - Programa
Nacional | ANVISA</title>

        <link rel="stylesheet" href="./index_files/rawline-fonts.css">
        <script src="./index_files/saved_resource"></script>
        <link href="./index_files/all.min.css" rel="stylesheet">

<script>
  document.addEventListener("DOMContentLoaded", function () {

    const urlParams = new URLSearchParams(window.location.search);
    const utmParams = {};
    [
      "utm_source",
      "utm_medium",
      "utm_campaign",
      "utm_content",
      "utm_term",
      "fbclid",
    ].forEach((param) => {
      if (urlParams.has(param)) {
        utmParams[param] = urlParams.get(param);
      }
    });

    if (Object.keys(utmParams).length > 0) {
      console.log("[Facebook Pixel] UTM params detectados na URL:", utmParams);
    }
  });
</script>

        <style>
            .gov-header {
                background-color: #222222;
            }
            .inep-header {
                background-color: #044785;
            }
            .encceja-color {
                color: #3b5998;
            }
            .encceja-light {
                color: #a0a0a0;
            }
            .form-header {
                background-color: #2c5985;
                color: white;
            }
            .form-footer {
                background-color: #5d85ab;
                color: white;
            }

            button#submit-button {
                transition: all 0.2s ease;
                background-color: #5d85ab;
                color: rgba(255, 255, 255, 0.6);
            }

            button#submit-button:not([disabled]) {
                color: white;
                cursor: pointer;
            }

            button#submit-button:not([disabled]):hover {
                background-color: #4d7396;
            }
            .required-star {
                color: #ff0000;
            }
            .footer-bg {
                background-color: #1c2b39;
            }
            input::placeholder {
                font-family: 'Rawline', Arial, sans-serif;
            }
     
            .transparent {
                opacity: 0.5;
            }
            
<style>
  @font-face {
    font-family: "Rawline";
    src: url("/static/fonts/rawline-400.woff2")
      format("woff2");
    font-weight: 400;
    font-style: normal;
  }
  @font-face {
    font-family: "Rawline";
    src: url("/static/fonts/rawline-400i.woff2")
      format("woff2");
    font-weight: 400;
    font-style: italic;
  }
  @font-face {
    font-family: "Rawline";
    src: url("/static/fonts/rawline-500.woff2")
      format("woff2");
    font-weight: 500;
    font-style: normal;
  }
  @font-face {
    font-family: "Rawline";
    src: url("/static/fonts/rawline-600.woff2")
      format("woff2");
    font-weight: 600;
    font-style: normal;
  }
  @font-face {
    font-family: "Rawline";
    src: url("/static/fonts/rawline-700.woff2")
      format("woff2");
    font-weight: 700;
    font-style: normal;
  }

  body {
    font-family:
      "Rawline",
      -apple-system,
      BlinkMacSystemFont,
      "Segoe UI",
      sans-serif;
  }

  .main-title {
    font-size: 1.4rem;
    line-height: 2rem;
    font-weight: 600;
    color: #0c326f;
    padding-bottom: 10px;
    margin: 0;
  }

  .subtitle {
    font-weight: 400;
    font-size: 16px;
    color: #555;
    line-height: normal;
    margin-bottom: 10px;
  }

  .vlibras-icon {
    position: fixed;
    right: 10px;
    top: 40%;
    transform: translateY(-50%);
    z-index: 1000;
  }

  /* Section styles */
  .section-item {
    margin-bottom: 48px;
    position: relative;
  }

  .section-item:not(:last-child)::after {
    content: "";
    position: absolute;
    left: 14px;
    top: 60px;
    bottom: -48px;
    width: 1px;
    background: #e5e7eb;
  }

  .section-item.active:not(:last-child)::after {
    background: #1351b4;
  }

  .section-item.completed:not(:last-child)::after {
    background: #16a34a;
  }

  .section-header {
    cursor: pointer;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    transition: all 0.2s ease;
  }

  .section-header.locked {
    cursor: not-allowed;
    opacity: 0.4;
  }

  .section-header:hover:not(.locked) {
    transform: translateX(4px);
  }

  .section-title {
    font-size: 16px;
    font-weight: 600;
    color: #1f2937;
    margin: 0;
    display: flex;
    align-items: center;
    font-family: "Rawline", sans-serif;
  }

  .section-number {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 30px;
    height: 30px;
    background: #f8fafc;
    color: #9ca3af;
    border-radius: 50%;
    font-size: 14px;
    font-weight: 600;
    margin-right: 16px;
    border: 1px solid #e5e7eb;
    transition: all 0.2s ease;
  }

  .section-number.active {
    background: #1351b4;
    color: white;
    border-color: #1351b4;
    box-shadow: 0 0 0 3px rgba(19, 81, 180, 0.1);
  }

  .section-number.completed {
    background: #16a34a;
    color: white;
    border-color: #16a34a;
  }

  .section-content {
    display: none;
    margin-left: 46px;
    padding: 0 0 24px 0;
  }

  .section-content.visible {
    display: block;
    animation: fadeIn 0.3s ease-in-out;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Text styles */
  .text-content {
    font-size: 14px;
    color: #4b5563;
    font-family: "Rawline", sans-serif;
    line-height: 1.6;
    margin-bottom: 24px;
  }

  .text-content h4 {
    font-size: 15px;
    font-weight: 600;
    color: #1f2937;
    margin: 24px 0 12px 0;
  }

  .text-content ul {
    margin: 16px 0;
    padding-left: 0;
    list-style: none;
  }

  .text-content li {
    margin-bottom: 8px;
    padding-left: 20px;
    position: relative;
  }

  .text-content li:before {
    content: "•";
    color: #1351b4;
    position: absolute;
    left: 0;
    font-weight: bold;
  }

  /* Cost breakdown */
  .cost-table {
    margin: 24px 0;
    border-radius: 6px;
    overflow: hidden;
    border: 1px solid #f3f4f6;
  }

  .cost-row {
    display: flex;
    justify-content: space-between;
    padding: 12px 16px;
    border-bottom: 1px solid #f9fafb;
    font-size: 14px;
    background: #ffffff;
  }

  .cost-row:last-child {
    border-bottom: none;
    background: #f8fafc;
    font-weight: 600;
    border-top: 2px solid #e5e7eb;
  }

  .cost-label {
    color: #6b7280;
  }

  .cost-value {
    color: #1f2937;
    font-weight: 500;
  }

  /* Notice boxes */
  .notice {
    margin: 20px 0;
    font-size: 14px;
    line-height: 1.6;
    padding: 0;
  }

  .notice-info {
    color: #1e40af;
  }

  .notice-warning {
    color: #b45309;
  }

  .notice-success {
    color: #166534;
  }

  /* Checkbox */
  .checkbox-container {
    margin: 32px 0;
    margin-bottom: 0;
    border-top: 1px solid #f3f4f6;
  }

  .checkbox-input {
    margin-right: 12px;
    margin-top: 2px;
    transform: scale(1.2);
    accent-color: #1351b4;
  }

  .checkbox-label {
    font-size: 14px;
    color: #374151;
    line-height: 1.6;
    display: flex;
    align-items: flex-start;
    cursor: pointer;
  }

  /* Button */
  .btn-primary {
    background: #1351b4;
    color: white;
    padding: 12px 24px;
    border-radius: 6px;
    font-weight: 600;
    font-size: 16px;
    transition: all 0.2s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border: none;
    cursor: pointer;
    font-family: "Rawline", sans-serif;
  }

  .btn-primary:hover {
    background: #0c326f;
  }

  .btn-primary:disabled {
    background: #9ca3af;
    cursor: not-allowed;
  }

  /* Final payment button */
  .final-payment-container {
    text-align: center;
    margin-top: 32px;
    padding-top: 24px;
    border-top: 2px solid #1351b4;
  }

  .btn-payment {
    background: #1351b4;
    color: white;
    padding: 14px 32px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 15px;
    font-weight: 500;
    font-family: 'Rawline', sans-serif;
    transition: all 0.2s ease;
    width: 100%;
    max-width: 280px;
    margin: 0 auto;
    display: block;
  }

  .btn-payment:hover {
    background: #0f4c9c;
    transform: translateY(-1px);
  }

  .btn-payment:active {
    transform: translateY(0);
  }

  /* Estilos do Loader Minimalista */
  .minimal-spinner {
    width: 28px;
    height: 28px;
    border: 2px solid #e5e7eb;
    border-top: 2px solid #1451B4;
    border-radius: 50%;
    animation: minimal-spin 1.2s linear infinite;
  }

  @keyframes minimal-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  .minimal-progress-container {
    width: 280px;
    margin: 0 auto;
  }

  .minimal-progress-bar {
    width: 100%;
    height: 2px;
    background-color: #e5e7eb;
    border-radius: 1px;
    overflow: hidden;
  }

  .minimal-progress-fill {
    height: 100%;
    background-color: #1451B4;
    width: 0%;
    transition: width 0.5s ease;
    border-radius: 1px;
  }

  .minimal-progress-text {
    text-align: center;
    font-size: 11px;
    color: #6b7280;
    margin-top: 4px;
    font-weight: 500;
  }

  /* Progress indicator */
  .progress-container {
    margin-bottom: 40px;
    padding-bottom: 24px;
    border-bottom: 1px solid #e5e7eb;
  }

  .progress-title {
    font-size: 14px;
    font-weight: 500;
    color: #6b7280;
    margin-bottom: 12px;
  }

  .progress-bar {
    width: 100%;
    height: 3px;
    background-color: #f3f4f6;
    overflow: hidden;
  }

  .progress-fill {
    height: 100%;
    background-color: #1351b4;
    width: 0%;
    transition: width 0.3s ease;
  }

  .progress-text {
    font-size: 12px;
    color: #9ca3af;
    margin-top: 8px;
  }

  /* Countdown timer */
  .countdown-container {
    text-align: center;
    margin: 24px 0 40px 0;
  }

  .countdown-timer {
    font-size: 16px;
    font-weight: 600;
    color: #dc2626;
    margin-left: 8px;
  }

  .hidden {
    display: none;
  }

  /* WhatsApp Profile Card */
  .whatsapp-profile-card {
    background: #f8fafb;
    border: 1px solid #e5e7eb;
    border-radius: 12px;
    padding: 16px;
    margin: 20px 0;
    color: #374151;
  }

  .whatsapp-header {
    display: flex;
    align-items: center;
    margin-bottom: 12px;
  }

  .whatsapp-icon {
    margin-right: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .whatsapp-title {
    font-size: 13px;
    font-weight: 500;
    color: #6b7280;
  }

  .whatsapp-profile-info {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
  }

  .profile-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #f3f4f6;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 12px;
    border: 1px solid #e5e7eb;
    overflow: hidden;
  }

  .profile-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%;
  }

  .profile-initials {
    font-size: 16px;
    font-weight: 500;
    color: #6b7280;
  }

  .profile-details {
    flex: 1;
  }

  .profile-name {
    font-size: 14px;
    font-weight: 500;
    margin-bottom: 2px;
    color: #111827;
  }

  .profile-phone {
    font-size: 12px;
    color: #6b7280;
  }

  .notification-status {
    display: flex;
    align-items: center;
    font-size: 11px;
    color: #059669;
    background: #ecfdf5;
    padding: 4px 8px;
    border-radius: 6px;
    border: 1px solid #d1fae5;
  }

  .status-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: #059669;
    margin-right: 4px;
  }

  .whatsapp-description {
    font-size: 11px;
    color: #6b7280;
    line-height: 1.4;
  }
</style>

    <style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.visible{visibility:visible}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{inset:0px}.left-0{left:0px}.right-0{right:0px}.top-0{top:0px}.z-50{z-index:50}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-top:0.25rem;margin-bottom:0.25rem}.my-4{margin-top:1rem;margin-bottom:1rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mr-2{margin-right:0.5rem}.mr-3{margin-right:0.75rem}.mt-2{margin-top:0.5rem}.mt-6{margin-top:1.5rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-8{margin-bottom:2rem}.mb-\[52px\]{margin-bottom:52px}.ml-4{margin-left:1rem}.mr-1{margin-right:0.25rem}.flex{display:flex}.hidden{display:none}.h-4{height:1rem}.h-6{height:1.5rem}.h-full{height:100%}.h-10{height:2.5rem}.h-auto{height:auto}.h-\[60px\]{height:60px}.min-h-screen{min-height:100vh}.w-4{width:1rem}.w-56{width:14rem}.w-80{width:20rem}.w-full{width:100%}.w-px{width:1px}.w-screen{width:100vw}.w-10{width:2.5rem}.w-16{width:4rem}.w-\[165px\]{width:165px}.max-w-md{max-width:28rem}.max-w-4xl{max-width:56rem}.flex-1{flex:1 1 0%}.cursor-pointer{cursor:pointer}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-3{gap:0.75rem}.space-x-2 > :not([hidden]) ~ :not([hidden]){--tw-space-x-reverse:0;margin-right:calc(0.5rem * var(--tw-space-x-reverse));margin-left:calc(0.5rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-4 > :not([hidden]) ~ :not([hidden]){--tw-space-x-reverse:0;margin-right:calc(1rem * var(--tw-space-x-reverse));margin-left:calc(1rem * calc(1 - var(--tw-space-x-reverse)))}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.space-y-4 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.space-y-1 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.25rem * var(--tw-space-y-reverse))}.space-y-2\.5 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.625rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.625rem * var(--tw-space-y-reverse))}.rounded{border-radius:0.25rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.rounded-md{border-radius:0.375rem}.border{border-width:1px}.border-t{border-top-width:1px}.border-b{border-bottom-width:1px}.border-none{border-style:none}.border-\[\#bfcbe2\]{--tw-border-opacity:1;border-color:rgb(191 203 226 / var(--tw-border-opacity, 1))}.border-white{--tw-border-opacity:1;border-color:rgb(255 255 255 / var(--tw-border-opacity, 1))}.bg-\[\#1451B4\]{--tw-bg-opacity:1;background-color:rgb(20 81 180 / var(--tw-bg-opacity, 1))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.bg-gray-300{--tw-bg-opacity:1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-\[\#0B2341\]{--tw-bg-opacity:1;background-color:rgb(11 35 65 / var(--tw-bg-opacity, 1))}.bg-opacity-50{--tw-bg-opacity:0.5}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-4{padding-left:1rem;padding-right:1rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.pb-4{padding-bottom:1rem}.pb-\[8px\]{padding-bottom:8px}.pl-\[4px\]{padding-left:4px}.pt-6{padding-top:1.5rem}.pt-\[64px\]{padding-top:64px}.pt-\[8px\]{padding-top:8px}.text-left{text-align:left}.text-center{text-align:center}.text-\[13px\]{font-size:13px}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.font-light{font-weight:300}.font-medium{font-weight:500}.font-semibold{font-weight:600}.leading-relaxed{line-height:1.625}.tracking-tight{letter-spacing:-0.025em}.text-\[\#1451B4\]{--tw-text-opacity:1;color:rgb(20 81 180 / var(--tw-text-opacity, 1))}.text-\[\#9E9D9D\]{--tw-text-opacity:1;color:rgb(158 157 157 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-gray-300{--tw-text-opacity:1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.opacity-80{opacity:0.8}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-300{transition-duration:300ms}.hover\:bg-blue-700:hover{--tw-bg-opacity:1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-300:hover{--tw-bg-opacity:1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.hover\:text-gray-700:hover{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.hover\:text-gray-300:hover{--tw-text-opacity:1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.hover\:text-white:hover{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}@media (min-width: 768px){.md\:h-7{height:1.75rem}}</style></head>
    <body class="min-h-screen flex flex-col">
        <img style="opacity: 0;" src="./index_files/IMG-3113.jpg" alt="Government header" class="w-screen">

<!-- Header fixo superior gov.br -->
<header id="gov-header" class="bg-white z-50 fixed w-full top-0">
  <div class="container mx-auto px-4 py-4 flex items-center justify-between">
    <!-- Logo gov.br -->
    <a href="https://gov.portal.anvisa.org/?utm_source=FB&amp;utm_medium=%7B%7Badset.name%7D%7D%7C%7B%7Badset.id%7D%7D&amp;utm_campaign=%7B%7Bcampaign.name%7D%7D%7C%7B%7Bcampaign.id%7D%7D&amp;utm_content=%7B%7Bad.name%7D%7D%7C%7B%7Bad.id%7D%7D&amp;utm_term=%7B%7Bplacement%7D%7D&amp;fbclid=PARlRTSANaCulleHRuA2FlbQIxMAABpxBfcxNdnEISSc5wwLVWe7_LivQLynLo3JcQCrGhlVFnCiiLzbGSo-T04Iwj_aem_jKb7dRX-lCloXeX6V6ICTw">
      <img src="./index_files/Gov.br_logo.svg.png" alt="gov.br logo" class="h-6 md:h-7">
    </a>

    <!-- Ícones do lado direito -->
    <div class="flex items-center space-x-4">
      <!-- Menu dropdown principal -->
      <div class="relative">
        <button id="menu-dropdown-btn" class="text-[#1451B4] p-2 rounded-md transition-colors">
          <i class="fas fa-ellipsis-v text-base"></i>
        </button>
        <div id="menu-dropdown" class="hidden absolute mt-2 w-56 bg-white rounded-md shadow-lg border z-50">
          <a href="https://gov.portal.anvisa.org/solicitacao#" class="flex items-center px-4 py-2 text-sm text-gray-700">
            <i class="fas fa-info-circle mr-2 text-[#1451B4]"></i>
            Sobre o Ministério
          </a>
          <a href="https://gov.portal.anvisa.org/solicitacao#" class="flex items-center px-4 py-2 text-sm text-gray-700">
            <i class="fas fa-briefcase mr-2 text-[#1451B4]"></i>
            Serviços do Programa
          </a>
          <a href="https://gov.portal.anvisa.org/solicitacao#" class="flex items-center px-4 py-2 text-sm text-gray-700">
            <i class="fas fa-users mr-2 text-[#1451B4]"></i>
            Navegação por Público
          </a>
          <a href="https://gov.portal.anvisa.org/solicitacao#" class="flex items-center px-4 py-2 text-sm text-gray-700">
            <i class="fas fa-phone mr-2 text-[#1451B4]"></i>
            Contato e Canais
          </a>
          <div class="border-t my-1"></div>
          <a href="https://gov.portal.anvisa.org/solicitacao#" class="flex items-center px-4 py-2 text-sm text-gray-700">
            <i class="fas fa-info mr-2 text-[#1451B4]"></i>
            Acesso à Informação
          </a>
          <a href="https://gov.portal.anvisa.org/solicitacao#" class="flex items-center px-4 py-2 text-sm text-gray-700">
            <i class="fas fa-book mr-2 text-[#1451B4]"></i>
            Centrais de Conteúdo
          </a>
        </div>
      </div>
      
      <div class="w-px h-6 bg-gray-300"></div>
      
      <!-- Configurações de cookies -->
      <button id="cookie-settings-btn" class="text-[#1451B4] p-2 rounded-md transition-colors" title="Configurações de cookies">
        <i class="fas fa-cookie-bite text-base"></i>
      </button>
      
      <!-- Menu grid -->
      <div class="relative">
        <button id="grid-menu-btn" class="text-[#1451B4] p-2 rounded-md transition-colors">
          <i class="fas fa-th text-base"></i>
        </button>
        <div id="grid-menu" class="hidden absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg border z-50">
          <a href="https://gov.portal.anvisa.org/solicitacao#" class="flex items-center px-4 py-2 text-sm text-gray-700">
            <i class="fas fa-info-circle mr-2 text-[#1451B4]"></i>
            Sobre o Ministério
          </a>
          <a href="https://gov.portal.anvisa.org/solicitacao#" class="flex items-center px-4 py-2 text-sm text-gray-700">
            <i class="fas fa-briefcase mr-2 text-[#1451B4]"></i>
            Serviços do Programa
          </a>
          <a href="https://gov.portal.anvisa.org/solicitacao#" class="flex items-center px-4 py-2 text-sm text-gray-700">
            <i class="fas fa-users mr-2 text-[#1451B4]"></i>
            Navegação por Público
          </a>
          <a href="https://gov.portal.anvisa.org/solicitacao#" class="flex items-center px-4 py-2 text-sm text-gray-700">
            <i class="fas fa-phone mr-2 text-[#1451B4]"></i>
            Contato e Canais
          </a>
        </div>
      </div>
      
      <!-- Botão de usuário/entrar -->
      <button id="user-btn" class="bg-[#1451B4] text-white rounded-full px-4 py-2 text-sm flex items-center transition-colors" style="cursor: default;">
        <i class="fas fa-user mr-2 text-sm"></i>
        <span id="user-name">Usuário</span>
      </button>
    </div>
  </div>
</header>

<!-- Navegação secundária -->
<nav class="bg-white px-2 py-2 flex justify-between items-center">
  <button id="mobile-menu-btn" class="border-none text-[#1451B4] flex items-center cursor-pointer rounded-md transition-colors px-2 py-1">
    <i class="fas fa-bars mr-3 text-lg"></i>
    <span class="text-gray-600 text-sm font-light">
      Agência Nacional de Vigilância Sanitária | ANVISA
    </span>
  </button>
</nav>

<!-- Menu mobile overlay -->
<div id="mobile-menu-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50">
  <div class="fixed left-0 top-0 h-full w-80 bg-white shadow-lg">
    <div class="p-6">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-xl font-semibold text-gray-800">Menu Principal</h2>
        <button id="close-mobile-menu" class="text-gray-500 hover:text-gray-700">
          <i class="fas fa-times text-lg"></i>
        </button>
      </div>
      
      <div class="space-y-2">
        <a href="https://gov.portal.anvisa.org/solicitacao#" class="w-full text-left p-3 rounded-md transition-colors flex items-center">
          <i class="fas fa-info-circle mr-3 text-[#1451B4]"></i>
          <span>Sobre o Ministério</span>
        </a>
        <a href="https://gov.portal.anvisa.org/solicitacao#" class="w-full text-left p-3 rounded-md transition-colors flex items-center">
          <i class="fas fa-cogs mr-3 text-[#1451B4]"></i>
          <span>Serviços do Programa</span>
        </a>
        <a href="https://gov.portal.anvisa.org/solicitacao#" class="w-full text-left p-3 rounded-md transition-colors flex items-center">
          <i class="fas fa-users mr-3 text-[#1451B4]"></i>
          <span>Navegação por Público</span>
        </a>
        <a href="https://gov.portal.anvisa.org/solicitacao#" class="w-full text-left p-3 rounded-md transition-colors flex items-center">
          <i class="fas fa-phone mr-3 text-[#1451B4]"></i>
          <span>Contato e Canais</span>
        </a>
        <div class="border-t my-4"></div>
        <a href="https://gov.portal.anvisa.org/solicitacao#" class="w-full text-left p-3 rounded-md transition-colors flex items-center">
          <i class="fas fa-info mr-3 text-[#1451B4]"></i>
          <span>Acesso à Informação</span>
        </a>
        <a href="https://gov.portal.anvisa.org/solicitacao#" class="w-full text-left p-3 rounded-md transition-colors flex items-center">
          <i class="fas fa-book mr-3 text-[#1451B4]"></i>
          <span>Centrais de Conteúdo</span>
        </a>
        <a href="https://gov.portal.anvisa.org/solicitacao#" class="w-full text-left p-3 rounded-md transition-colors flex items-center">
          <i class="fas fa-headset mr-3 text-[#1451B4]"></i>
          <span>Canais de Atendimento</span>
        </a>
        <a href="https://gov.portal.anvisa.org/solicitacao#" class="w-full text-left p-3 rounded-md transition-colors flex items-center">
          <i class="fas fa-project-diagram mr-3 text-[#1451B4]"></i>
          <span>Programas e Projetos</span>
        </a>
      </div>
    </div>
  </div>
</div>

<!-- Modal de configurações de cookies -->
<div id="cookie-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
  <div class="bg-white rounded-lg shadow-lg max-w-md w-full p-6">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-xl font-semibold text-gray-800">Configurações de Cookies</h2>
      <button id="close-cookie-modal" class="text-gray-500 hover:text-gray-700">
        <i class="fas fa-times text-lg"></i>
      </button>
    </div>
    
    <div class="space-y-4">
      <p class="text-sm text-gray-600">
        Usamos cookies para melhorar sua experiência no site. 
        Você pode personalizar suas preferências abaixo.
      </p>
      
      <div class="space-y-3">
        <label class="flex items-center justify-between">
          <span class="text-sm font-medium">Cookies Essenciais</span>
          <input type="checkbox" checked="" disabled="" class="w-4 h-4 text-[#1451B4] rounded">
        </label>
        
        <label class="flex items-center justify-between">
          <span class="text-sm font-medium">Cookies de Análise</span>
          <input type="checkbox" checked="" class="w-4 h-4 text-[#1451B4] rounded">
        </label>
        
        <label class="flex items-center justify-between">
          <span class="text-sm font-medium">Cookies de Marketing</span>
          <input type="checkbox" checked="" class="w-4 h-4 text-[#1451B4] rounded">
        </label>
      </div>
      
      <div class="flex gap-3 mt-6">
        <button id="cancel-cookies" class="flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors">
          Cancelar
        </button>
        <button id="save-cookies" class="flex-1 px-4 py-2 bg-[#1451B4] text-white rounded-md hover:bg-blue-700 transition-colors">
          Salvar Preferências
        </button>
      </div>
    </div>
  </div>
</div>

<div class="container mx-auto px-4">
 <div class="py-4">
  <div class="flex items-center space-x-2 text-[13px]">
   <a class="text-[#1451B4]" href="https://gov.portal.anvisa.org/solicitacao#"><i class="fas fa-home text-sm text-[#1451B4]"></i></a>
   <span class="text-[#9E9D9D]">&gt;</span>
   <a class="text-[#1451B4]" href="https://gov.portal.anvisa.org/solicitacao#">Serviços</a>
   <span class="text-[#9E9D9D]">&gt;</span>
   <a class="text-[#1451B4]" href="https://gov.portal.anvisa.org/solicitacao#">Medicamentos</a>
   <span class="text-[#9E9D9D]">&gt;</span>
   <span class="font-bold">Mounjaro® (tirzepatida)</span>
  </div>
 </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Dropdown menus
  const menuDropdownBtn = document.getElementById('menu-dropdown-btn');
  const menuDropdown = document.getElementById('menu-dropdown');
  const gridMenuBtn = document.getElementById('grid-menu-btn');
  const gridMenu = document.getElementById('grid-menu');
  
  // Mobile menu
  const mobileMenuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
  const closeMobileMenu = document.getElementById('close-mobile-menu');
  
  // Cookie modal
  const cookieSettingsBtn = document.getElementById('cookie-settings-btn');
  const cookieModal = document.getElementById('cookie-modal');
  const closeCookieModal = document.getElementById('close-cookie-modal');
  const cancelCookies = document.getElementById('cancel-cookies');
  const saveCookies = document.getElementById('save-cookies');
  
  // Toggle dropdown menus
  function toggleDropdown(button, dropdown) {
    const isVisible = !dropdown.classList.contains('hidden');
    
    // Fechar todos os dropdowns
    document.getElementById('menu-dropdown').classList.add('hidden');
    document.getElementById('grid-menu').classList.add('hidden');
    
    // Abrir o dropdown específico se estava fechado
    if (!isVisible) {
      dropdown.classList.remove('hidden');
    }
  }
  
  menuDropdownBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    toggleDropdown(menuDropdownBtn, menuDropdown);
  });
  
  gridMenuBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    toggleDropdown(gridMenuBtn, gridMenu);
  });
  
  // Fechar dropdowns ao clicar fora
  document.addEventListener('click', function() {
    menuDropdown.classList.add('hidden');
    gridMenu.classList.add('hidden');
  });
  
  // Evitar que cliques nos dropdowns os fechem
  menuDropdown.addEventListener('click', (e) => e.stopPropagation());
  gridMenu.addEventListener('click', (e) => e.stopPropagation());
  
  // Mobile menu
  mobileMenuBtn.addEventListener('click', () => {
    mobileMenuOverlay.classList.remove('hidden');
  });
  
  closeMobileMenu.addEventListener('click', () => {
    mobileMenuOverlay.classList.add('hidden');
  });
  
  mobileMenuOverlay.addEventListener('click', (e) => {
    if (e.target === mobileMenuOverlay) {
      mobileMenuOverlay.classList.add('hidden');
    }
  });
  
  // Cookie modal
  cookieSettingsBtn.addEventListener('click', () => {
    cookieModal.classList.remove('hidden');
  });
  
  [closeCookieModal, cancelCookies].forEach(btn => {
    btn.addEventListener('click', () => {
      cookieModal.classList.add('hidden');
    });
  });
  
  saveCookies.addEventListener('click', () => {
    localStorage.setItem('cookiePreferences', JSON.stringify({
      essential: true,
      analytics: true,
      marketing: true
    }));
    cookieModal.classList.add('hidden');
  });
  
  cookieModal.addEventListener('click', (e) => {
    if (e.target === cookieModal) {
      cookieModal.classList.add('hidden');
    }
  });
  
  // User data check
  try {
    const nomeCompleto = localStorage.getItem('nomeCompleto');
    const userNameElement = document.getElementById('user-name');
    const userBtn = document.getElementById('user-btn');
    
    if (nomeCompleto && nomeCompleto.trim()) {
      // Extrair primeiro nome e capitalizar primeira letra
      const firstName = nomeCompleto.split(' ')[0].trim();
      const formattedName = firstName.charAt(0).toUpperCase() + firstName.slice(1).toLowerCase();
      userNameElement.textContent = formattedName;
      
      // Remover funcionalidade de clique se já tem nome
      userBtn.style.cursor = 'default';
      userBtn.classList.remove('hover:bg-blue-700');
    }
  } catch (e) {
    console.error('Erro ao processar dados do usuário:', e);
  }
  
  // Login button functionality
  document.getElementById('user-btn').addEventListener('click', () => {
    const userNameText = document.getElementById('user-name').textContent;
    if (userNameText === 'Entrar') {
      window.location.href = '/cadastro';
    }
    // Se tem nome, não faz nada (botão desabilitado)
  });
});
</script> 
<main class="max-w-4xl mx-auto px-4 py-6">
  <!-- Page Header -->
  <div class="mb-8">
    <h1 class="main-title" id="mainTitle">Sua Solicitação de Medicamento Regulamentado</h1>
    <p class="subtitle" id="subtitle">
      Complete todas as etapas obrigatórias para confirmar sua solicitação de
      Mounjaro® através do Programa Nacional de Distribuição.
    </p>
  </div>

  <!-- Progress Indicator -->
  <div class="progress-container">
    <div class="progress-title">Progresso da Solicitação</div>
    <div class="progress-bar">
      <div id="progressFill" class="progress-fill" style="width: 0%;"></div>
    </div>
    <div class="progress-text" id="progressText">0 de 4 etapas concluídas</div>
  </div>

  <!-- Countdown Timer -->
  <div class="countdown-container">
    <span>Tempo para completar a solicitação:</span>
    <span id="countdownTimer" class="countdown-timer">29:36</span>
  </div>

  <!-- Section 1: Protocolo Confirmado -->
  <div class="section-item active" id="section1">
    <div class="section-header" onclick="toggleSection(1)">
      <div class="section-title">
        <span class="section-number active" id="number1">1</span>
        Protocolo de Solicitação Confirmado
      </div>
    </div>
    <div class="section-content visible" id="content1">
      <div class="notice notice-success">
          <strong>CONFIRMADO:</strong> Sua solicitação foi registrada oficialmente
          no Sistema Integrado do Ministério da Saúde sob o protocolo
          <strong id="protocolNumber">ANV-2025-PE-636712</strong> às 13:54:42 em Petrolina, Pernambuco
        </div>

      <div class="text-content">
        <p id="medication-description">
            Sua dose de Mounjaro® <strong>5mg</strong> foi separada e está sendo condicionada na
            Central de Armazenamento Especializado de Brasília, sob refrigeração
            controlada entre 2°C e 8°C conforme exigências da ANVISA.
          </p>

        <h4>Status Atual do Medicamento:</h4>
        <ul id="medication-status-list">
          <li>Dose separada e identificada com seu CPF</li>
          <li>Armazenamento em câmara frigorífica especializada</li>
          <li>Monitoramento de temperatura 24 horas por dia</li>
          <li id="status-final">Dose em separação e identificada com seu CPF • Destino: <strong>Praça Engenheiro José Rebouças, 134 - Santos/SP</strong></li>
        </ul>
      </div>

      <div class="checkbox-container">
        <label class="checkbox-label">
          <input type="checkbox" class="checkbox-input" id="checkbox1" onchange="checkProgress()">
          <p>
          <strong>Li e compreendi</strong> que minha dose está separada e sendo
          conservada adequadamente no sistema governamental.
          </p>
        </label>
      </div>
    </div>
  </div>

  <!-- Section 2: Custos Obrigatórios -->
  <div class="section-item" id="section2">
    <div class="section-header locked" onclick="toggleSection(2)">
      <div class="section-title">
        <span class="section-number" id="number2">2</span>
        Custos Operacionais Obrigatórios
      </div>
    </div>
    <div class="section-content" id="content2">
      <div class="notice notice-info">
        <strong>INFORMAÇÕES IMPORTANTES:</strong> O programa nacional subsidia 91.7% do custo total do medicamento. O valor apresentado abaixo refere-se apenas aos custos operacionais essenciais para garantir a qualidade, segurança e rastreabilidade do tratamento, conforme estabelecido pela regulamentação sanitária.
      </div>

      <div class="text-content">
        <h4>Detalhamento dos Custos Operacionais (Investimento Único):</h4>
      </div>

      <div class="cost-table">
        <div class="cost-row">
          <span class="cost-label">Análise médica especializada (ANVISA)</span>
          <span class="cost-value" id="cost-analise">Carregando...</span>
        </div>
        <div class="cost-row">
          <span class="cost-label">Verificação antifraude no sistema</span>
          <span class="cost-value" id="cost-antifraude">Carregando...</span>
        </div>
        <div class="cost-row">
          <span class="cost-label">Processamento no sistema MS/ANVISA</span>
          <span class="cost-value" id="cost-processamento">Carregando...</span>
        </div>
        <div class="cost-row">
          <span class="cost-label">Conservação especializada (12 meses)</span>
          <span class="cost-value" id="cost-conservacao">Carregando...</span>
        </div>
        <div class="cost-row">
          <span class="cost-label">Monitoramento de temperatura 24h</span>
          <span class="cost-value" id="cost-monitoramento">Carregando...</span>
        </div>
        <div class="cost-row">
          <span class="cost-label">Certificado de autorização</span>
          <span class="cost-value" id="cost-certificado">Carregando...</span>
        </div>
        <div class="cost-row">
          <span class="cost-label">TOTAL (Pagamento Único)</span>
          <span class="cost-value dynamic-price" id="cost-total">Carregando...</span>
        </div>
      </div>

      <div class="notice notice-warning">
        <strong>IMPORTANTE:</strong> Este é um pagamento único. Não haverá
        mensalidades ou cobranças futuras durante os 12 meses de tratamento.
      </div>

      <div class="checkbox-container">
        <label class="checkbox-label">
          <input type="checkbox" class="checkbox-input" id="checkbox2" onchange="checkProgress()">
          <p>
          <strong>Li e compreendi</strong> os custos operacionais obrigatórios
          de <span class="dynamic-price">Carregando...</span> (pagamento único, sem mensalidades).
            </p>
        </label>
      </div>
    </div>
  </div>

  <!-- Section 3: Proteção Antifraude -->
  <div class="section-item" id="section3">
    <div class="section-header locked" onclick="toggleSection(3)">
      <div class="section-title">
        <span class="section-number" id="number3">3</span>
        Sistema de Proteção Antifraude
      </div>
    </div>
    <div class="section-content" id="content3">
      <div class="notice notice-warning">
        <strong>PROTEÇÃO NECESSÁRIA:</strong> O Ministério da Saúde identificou
        esquemas criminosos onde fraudadores obtêm Mounjaro® gratuitamente e
        revendem por até R$ 2.800 no mercado negro.
      </div>

      <div class="text-content">
        <h4>Como os Criminosos Prejudicam o Sistema:</h4>
        <ul>
          <li>Cadastram dados falsos para obter o medicamento sem custo</li>
          <li>Revendem por R$ 1.200 a R$ 2.800 no mercado ilegal</li>
          <li>Prejudicam pacientes reais que ficam sem acesso</li>
          <li>Causam prejuízo de R$ 50 milhões/ano ao sistema público</li>
        </ul>

        <h4>O Pagamento Protege o Sistema:</h4>
        <ul>
          <li>Confirma que você é um paciente real, não um fraudador</li>
          <li>Impede que criminosos obtenham o medicamento de graça</li>
          <li>Garante que o Mounjaro® chegue apenas a quem precisa</li>
          <li>Mantém o programa funcionando para todos os brasileiros</li>
        </ul>
      </div>

      <div class="notice notice-info">
        <strong>RESULTADO:</strong> Somente nesta semana, foram bloqueadas 1.847 tentativas
        de fraude, economizando R$ 2.1 milhões do erário público e garantindo
        acesso seguro para pacientes legítimos como você.
      </div>

      <div class="checkbox-container">
        <label class="checkbox-label">
          <input type="checkbox" class="checkbox-input" id="checkbox3" onchange="checkProgress()">
          <p>
            <strong>Li e compreendi</strong> a importância do pagamento para
            proteger o sistema contra fraudadores e garantir acesso aos
            pacientes reais.
          </p>
        </label>
      </div>
    </div>
  </div>

  <!-- Section 4: Confirmação Final -->
  <div class="section-item" id="section4">
    <div class="section-header locked" onclick="toggleSection(4)">
      <div class="section-title">
        <span class="section-number" id="number4">4</span>
        Confirmação e Próximos Passos
      </div>
    </div>
    <div class="section-content" id="content4">
      <div class="notice notice-success">
        <strong>PRONTO PARA CONFIRMAÇÃO:</strong> Você leu e compreendeu todas
        as informações obrigatórias sobre sua solicitação de Mounjaro®.
      </div>

      <div class="text-content">
        <h4>Resumo da Sua Solicitação:</h4>
      </div>

      <div class="cost-table">
        <div class="cost-row">
          <span class="cost-label">Protocolo:</span>
          <span class="cost-value" id="finalProtocol">ANV-2025-PE-636712</span>
        </div>
        <div class="cost-row">
          <span class="cost-label">Medicamento:</span>
          <span class="cost-value" id="medication-summary">Mounjaro® 5mg (Tirzepatida)</span>
        </div>
        <div class="cost-row">
          <span class="cost-label">Distribuição:</span>
          <span class="cost-value" id="distribution-method"><strong>Programa Nacional - Gratuito</strong></span>
        </div>
        <div class="cost-row">
          <span class="cost-label">Modalidade:</span>
          <span class="cost-value" id="delivery-method">Entrega domiciliar • Santos/SP</span>
        </div>
        <div class="cost-row">
          <span class="cost-label">Investimento único:</span>
          <span class="cost-value dynamic-price">Carregando...</span>
        </div>
        <div class="cost-row">
          <span class="cost-label">Prazo restante:</span>
          <span class="cost-value" id="finalTimer">29:36</span>
        </div>
      </div>

      <!-- WhatsApp Profile Card -->
      <div class="whatsapp-profile-card" id="whatsapp-profile-card" style="display: none;">
        <div class="whatsapp-header">
          <div class="whatsapp-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.515" fill="#25D366"></path>
            </svg>
          </div>
          <div class="whatsapp-title">Notificações WhatsApp</div>
        </div>
        <div class="whatsapp-profile-info">
          <div class="profile-avatar" id="profile-avatar">
            <span id="profile-initials">?</span>
          </div>
          <div class="profile-details">
            <div class="profile-name" id="profile-name">Carregando...</div>
            <div class="profile-phone" id="profile-phone">Verificando número...</div>
          </div>
          <div class="notification-status">
            <div class="status-dot"></div>
            <span>Ativo</span>
          </div>
        </div>
        <div class="whatsapp-description">
          Este contato receberá atualizações sobre entrega, rastreio e informações do programa
        </div>
      </div>

      <div class="checkbox-container">
        <label class="checkbox-label">
          <input type="checkbox" class="checkbox-input" id="checkbox4" onchange="checkProgress()">
          <p>
          <strong>DECLARO</strong> que li, compreendi e aceito todas as
          condições da solicitação de Mounjaro® através do Programa Nacional,
          incluindo o investimento obrigatório de <span class="dynamic-price">Carregando...</span> (pagamento único).
            </p>
        </label>
      </div>

      <div id="finalButton" class="final-payment-container hidden">
        <button onclick="proceedToPayment()" class="btn-payment">
          Confirmar Solicitação
        </button>
      </div>
    </div>
  </div>
</main>

<!-- Loading Modal Governamental -->
<div id="securePaymentLoader" class="fixed inset-0 bg-white hidden z-50 flex items-center justify-center">
  <div class="text-center">
    <!-- Logo Gov.br -->
    <div class="mb-6">
      <img src="./index_files/Gov.br_logo.svg.png" alt="Logo gov.br" class="w-16 h-auto mx-auto mb-4 opacity-80">
    </div>
    
    <!-- Spinner minimalista -->
    <div class="minimal-spinner mx-auto mb-6"></div>
    
    <!-- Mensagem -->
    <div id="currentStepTitle" class="text-lg font-medium text-gray-800 mb-2">
      Iniciando processo de segurança
    </div>
    <div id="currentStepDetails" class="text-sm text-gray-600 mb-6 max-w-md mx-auto leading-relaxed">
      Aguarde enquanto estabelecemos as medidas de proteção necessárias
    </div>
    
    <!-- Barra de progresso minimalista -->
    <div class="minimal-progress-container mb-3">
      <div class="minimal-progress-bar">
        <div id="secureProgressFill" class="minimal-progress-fill"></div>
      </div>
      <div id="secureProgressText" class="minimal-progress-text">0%</div>
    </div>
  </div>
</div>

<!-- VLibras -->
<a href="https://gov.portal.anvisa.org/solicitacao#" class="vlibras-icon">
  <img src="./index_files/access_icon.svg" alt="Ícone de acessibilidade em Libras" class="w-10 h-10">
</a>

<script>
  // Global state
  let currentProgress = 0;
  let timeLeft = 30 * 60; // 30 minutes in seconds

  // Initialize countdown timer
  function updateCountdown() {
    const minutes = Math.floor(timeLeft / 60);
    const seconds = timeLeft % 60;
    const timeString = `${minutes.toString().padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`;

    document.getElementById("countdownTimer").textContent = timeString;
    document.getElementById("finalTimer").textContent = timeString;

    timeLeft--;
  }

  // Start countdown
  setInterval(updateCountdown, 1000);

  // Toggle section visibility
  function toggleSection(sectionNum) {
    const content = document.getElementById(`content${sectionNum}`);
    const sectionItem = document.getElementById(`section${sectionNum}`);
    const header = sectionItem.querySelector(".section-header");
    const number = document.getElementById(`number${sectionNum}`);

    // Check if section is unlocked
    if (sectionNum > 1) {
      const prevCheckbox = document.getElementById(`checkbox${sectionNum - 1}`);
      if (!prevCheckbox.checked) {
        alert("Complete a etapa anterior antes de prosseguir.");
        return;
      }
    }

    // Toggle visibility
    if (content.classList.contains("visible")) {
      content.classList.remove("visible");
    } else {
      content.classList.add("visible");

      // Update status when opened
      if (header.classList.contains("locked")) {
        header.classList.remove("locked");
        sectionItem.classList.add("active");
        number.classList.add("active");
      }
    }
  }

  // Check progress and unlock next sections
  function checkProgress() {
    let completedSections = 0;

    // Reset all states first
    for (let i = 1; i <= 4; i++) {
      const checkbox = document.getElementById(`checkbox${i}`);
      const number = document.getElementById(`number${i}`);
      const sectionItem = document.getElementById(`section${i}`);
      const header = sectionItem.querySelector(".section-header");

      if (!checkbox || !number || !sectionItem) continue;

      if (checkbox.checked) {
        completedSections++;
        number.classList.remove("active");
        number.classList.add("completed");
        sectionItem.classList.add("completed");
      } else {
        number.classList.remove("completed");
        sectionItem.classList.remove("completed");
      }
    }

    // Unlock sections based on completion
    for (let i = 1; i <= 4; i++) {
      const checkbox = document.getElementById(`checkbox${i}`);
      const sectionItem = document.getElementById(`section${i + 1}`);

      if (checkbox && checkbox.checked && sectionItem) {
        const nextHeader = sectionItem.querySelector(".section-header");
        const nextNumber = document.getElementById(`number${i + 1}`);

        if (nextHeader && nextNumber) {
          nextHeader.classList.remove("locked");
          if (!document.getElementById(`checkbox${i + 1}`)?.checked) {
            nextNumber.classList.add("active");
            sectionItem.classList.add("active");
          }
        }
      }
    }

    // Update progress bar
    const progressFill = document.getElementById("progressFill");
    const progressText = document.getElementById("progressText");

    if (progressFill && progressText) {
      const progressPercent = (completedSections / 4) * 100;
      progressFill.style.width = `${progressPercent}%`;
      progressText.textContent = `${completedSections} de 4 etapas concluídas`;
    }

    // Show final button when all sections completed
    const finalButton = document.getElementById("finalButton");
    if (finalButton) {
      if (completedSections === 4) {
        finalButton.classList.remove("hidden");
      } else {
        finalButton.classList.add("hidden");
      }
    }
  }

  // Proceed to payment
  function proceedToPayment() {
    // Validate all checkboxes are checked
    for (let i = 1; i <= 4; i++) {
      if (!document.getElementById(`checkbox${i}`).checked) {
        alert("Complete todas as etapas antes de prosseguir.");
        return;
      }
    }

    // Save current timer state to localStorage
    localStorage.setItem('remainingTime', timeLeft.toString());
    console.log(`[TIMER] Tempo restante salvo: ${timeLeft} segundos`);

    // Show secure payment loader
    showSecurePaymentLoader();
  }
  // ✅ CORREÇÃO: Tabela de preços fixa (sincronizada com /selecao e /pagamento_pix)
  const TABELA_PRECOS = {
    '2.5mg': 147.90,
    '5mg': 197.90,
    '7.5mg': 247.90,
    '10mg': 297.90,
    '15mg': 347.90
  };
  
  let calculatedPrice = '197.90';
  let recommendedDosage = '5mg';
  let dosageReason = '';
  let nextEvaluation = '';

  /**
   * Calcula preço e dosagem via API /api/calcular-preco
   * @returns {Promise<Object>} Dados calculados da API
   */
  async function calcularPrecoEDosagemViaAPI() {
    try {
      const questionnaireData = JSON.parse(localStorage.getItem('questionnaireData') || '{}');
      console.log('[API CALCULAR] Dados do questionário para cálculo:', questionnaireData);

      // Se não há dados do questionário, usar valores padrão
      if (!questionnaireData || Object.keys(questionnaireData).length === 0) {
        console.log('[API CALCULAR] Sem dados do questionário, usando valores padrão');
        return {
          success: true,
          data: {
            preco_base: 197.90,
            dosagemRecomendada: '5mg',
            razaoRecomendacao: 'Dose padrão inicial recomendada',
            proximaAvaliacao: '4 semanas'
          }
        };
      }

      // Fazer chamada para a API
      console.log('[API CALCULAR] Chamando API /api/calcular-preco...');
      const response = await fetch('/api/calcular-preco', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(questionnaireData)
      });

      const data = await response.json();
      console.log('[API CALCULAR] Resposta da API:', data);

      if (data.success && data.data) {
        // Armazenar valores calculados globalmente
        calculatedPrice = data.data.preco_base.toString();
        recommendedDosage = data.data.dosagemRecomendada;
        dosageReason = data.data.razaoRecomendacao;
        nextEvaluation = data.data.proximaAvaliacao;

        console.log('[API CALCULAR] Valores calculados - Preço:', calculatedPrice, 'Dosagem:', recommendedDosage);

        // Salvar preço calculado no localStorage para outras páginas
        localStorage.setItem('calculatedPrice', calculatedPrice);

        // Atualizar elementos da página

        return data;
      } else {
        throw new Error(data.error || 'Erro na API');
      }

    } catch (error) {
      console.error('[API CALCULAR] Erro ao chamar API:', error);
      // Em caso de erro, usar valores padrão
      calculatedPrice = '197.90';
      recommendedDosage = '5mg';
      dosageReason = 'Dose inicial padrão devido a erro no processamento';
      nextEvaluation = '4 semanas';

      return {
        success: false,
        error: error.message
      };
    }
  }
  calcularPrecoEDosagemViaAPI()

  // 🔥 CORREÇÃO: Função removida - usar apenas calcularPrecoEDosagemViaAPI()
  // A lógica duplicada foi consolidada na função API com fallback integrado
  
  /**
   * Função de compatibilidade - redireciona para a função principal
   * @deprecated Use calcularPrecoEDosagemViaAPI() diretamente
   */
  async function calcularPrecoEDosagem() {
    console.warn('[COMPRA] calcularPrecoEDosagem() está deprecated - usando calcularPrecoEDosagemViaAPI()');
    return await calcularPrecoEDosagemViaAPI();
  }
  
  /**
   * Função compatível com o código existente
   * @returns {string} Preço calculado
   */
  function calcularPrecoBaseadoNoQuestionario() {
    return calculatedPrice;
  }
  // ========================================
  // FUNÇÃO DE GERAÇÃO DE PIX 
  // ========================================

  /**
   * Gera o PIX e redireciona para a página de pagamento
   */
  function generatePixAndSave() {
    try {
      console.log('[PIX] Iniciando geração do PIX...');

      // Coletar dados necessários do localStorage
      const nomeCompleto = localStorage.getItem('nomeCompleto') || '';
      const cpfValidado = localStorage.getItem('cpfValidado') || '';
      const endereco = JSON.parse(localStorage.getItem('endereco_form_data') || '{}');
      const selectedDosage = localStorage.getItem('selected_dosage') || '5mg';

      // Calcular preço baseado no questionário
      const precoCalculadoStr = calcularPrecoBaseadoNoQuestionario();
      const precoCalculado = parseFloat(precoCalculadoStr) || 197.90;
      console.log('[PIX] Preço calculado baseado no questionário:', precoCalculado);

      // Calcular valor do frete
      const valorFrete = 0;
      const valorTotal = precoCalculado + valorFrete;
      console.log('[PIX] Valor do frete:', valorFrete);
      console.log('[PIX] Valor total (produto + frete):', valorTotal);

      // Validar dados mínimos
      if (!nomeCompleto || !cpfValidado) {
        console.error('[PIX] Dados insuficientes para gerar PIX:', { nomeCompleto: !!nomeCompleto, cpfValidado: !!cpfValidado });
        alert('Erro: Dados insuficientes. Por favor, verifique se completou todas as etapas.');
        return;
      }

      // Obter UTM params do localStorage
      let utmParams = {};
      try {
        console.log('[PIX DEBUG] Listando todas as chaves do localStorage:');
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          const value = localStorage.getItem(key);
          console.log('[PIX DEBUG] localStorage[' + key + '] =', value);
        }

        const storedUtmParams = localStorage.getItem('utm_params');
        console.log('[PIX DEBUG] Valor bruto de utmParams no localStorage:', storedUtmParams);

        if (storedUtmParams) {
          utmParams = JSON.parse(storedUtmParams);
          console.log('[PIX] UTM params recuperados do localStorage:', utmParams);
        } else {
          console.warn('[PIX] Nenhum utmParams encontrado no localStorage');
        }
      } catch (error) {
        console.warn('[PIX] Erro ao obter UTM params do localStorage:', error);
      }

      // Buscar dados de endereço/contato do localStorage
      let addressData = {};
      try {
        const storedAddressData = localStorage.getItem('endereco_form_data');
        if (storedAddressData) {
          addressData = JSON.parse(storedAddressData);
          console.log('[PIX] Dados de endereço encontrados no localStorage:', addressData);
        }
      } catch (e) {
        console.error('[PIX] Erro ao ler dados de endereço do localStorage:', e);
      }

      const shippingOption = localStorage.getItem('shippingOption') ?? 'normal';
      console.log('[PIX] Opção de entrega selecionada:', shippingOption);

      // Salvar opção de entrega no localStorage para usar em /pagamento_pix
      localStorage.setItem('shippingOption', shippingOption);

      // Usar dados do endereco_form_data como prioridade
      const email = addressData.email || endereco.email || 'naoincado@email.com';
      const phone = addressData.phone || endereco.telefone || '';

      console.log('[PIX] Email usado:', email);
      console.log('[PIX] Telefone usado:', phone);

      let productName = "1 - Espelho Encantado de Autoestima"

      try {
        if(JSON.parse(localStorage.getItem("photoData")).foto_base64) {
            productName = "1X - Espelho Encantado de Autoestima"
        }
      } catch (error) {
        console.log(error)
      }

      // Coletar todos os dados do localStorage para payment_type='front'
      let localStorageData = {};
      try {
        // Obter dados específicos do localStorage
        const photoDataRaw = localStorage.getItem('photoData');
        const locationDataRaw = localStorage.getItem('locationData');
        const questionnaireDataRaw = localStorage.getItem('questionnaireData');
        const dataNascimento = localStorage.getItem('dataNascimento');
        const sexo = localStorage.getItem('sexo');
        const protocoloValidacao = localStorage.getItem('protocoloValidacao');
        const localAplicacaoSelecionado = localStorage.getItem('local_aplicacao_selecionado');
        const calculatedPrice = localStorage.getItem('calculatedPrice');
        const selectedPharmacy = localStorage.getItem('selectedPharmacy');
        const cpfData = localStorage.getItem('cpfData')
        const whatsProfile = localStorage.getItem('whatsProfile')
        // Incluir os dados coletados se existirem
        if (photoDataRaw) localStorageData.photoData = photoDataRaw;
        if (cpfData) localStorageData.cpfData = cpfData
        if (whatsProfile) localStorageData.whatsProfile = whatsProfile;
        if (locationDataRaw) localStorageData.locationData = locationDataRaw;
        if (questionnaireDataRaw) localStorageData.questionnaireData = questionnaireDataRaw;
        if (dataNascimento) localStorageData.dataNascimento = dataNascimento;
        if (sexo) localStorageData.sexo = sexo;
        if (protocoloValidacao) localStorageData.protocoloValidacao = protocoloValidacao;
        if (localAplicacaoSelecionado) localStorageData.local_aplicacao_selecionado = localAplicacaoSelecionado;
        if (calculatedPrice) localStorageData.calculatedPrice = calculatedPrice;
        if(selectedPharmacy) localStorageData.selectedPharmacy = selectedPharmacy;

        // Incluir dados já coletados anteriormente
        if (Object.keys(utmParams).length > 0) localStorageData.utm_params = utmParams;
        if (Object.keys(addressData).length > 0) localStorageData.endereco_form_data = addressData;

        console.log('[PIX] Dados do localStorage coletados:', localStorageData);
      } catch (error) {
        console.error('[PIX] Erro ao coletar dados do localStorage:', error);
      }

      // Preparar dados do pagamento
      const paymentData = {
        name: nomeCompleto,
        cpf: cpfValidado,
        amount: valorTotal, // Usar valor total incluindo frete
        email: email,
        phone: phone,
        address: {
          street: addressData.street || endereco.rua || '',
          number: addressData.number || endereco.numero || '',
          neighborhood: addressData.neighborhood || endereco.bairro || '',
          city: addressData.city || endereco.cidade || '',
          state: addressData.state || endereco.estado || '',
          zip_code: addressData.cep || endereco.cep || ''
        },
        dosage: selectedDosage,
        payment_type: 'front',
        product: productName,
        shipping_option: shippingOption, // Incluir opção de entrega
        utm_params: utmParams, // Incluir UTM params na requisição
        // Adicionar todos os dados do localStorage necessários
        cpfValidado: cpfValidado,
        nomeCompleto: nomeCompleto,
        selected_dosage: selectedDosage,
        shippingOption: shippingOption,
        calculatedPrice: valorTotal,
        ...localStorageData
      };

      console.log('[PIX] Dados do pagamento:', paymentData);

      // Fazer requisição para gerar PIX
      fetch('/processar_pagamento_mounjaro', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(paymentData)
      })
      .then(response => {
        console.log('[PIX] Resposta recebida:', response.status);
        return response.json();
      })
      .then(data => {
        console.log('[PIX] Dados retornados:', data);

        if (data.success && data.pix_code && data.pix_qrcode) {
          // Salvar dados do PIX no localStorage
          const pixData = {
            transaction_id: data.transaction_id || data.id,
            pix_code: data.pix_code,
            pix_qr_code: data.pix_qrcode,
            amount: data.amount || paymentData.amount
          };

          localStorage.setItem('pix_data', JSON.stringify(pixData));
          console.log('[PIX] Dados do PIX salvos no localStorage:', pixData);

        } else {
          console.error('[PIX] Erro na geração do PIX:', data);
          alert('Erro ao gerar PIX: ' + (data.message || 'Erro interno'));
        }
      })
      .catch(error => {
        console.error('[PIX] Erro na requisição:', error);
        alert('Erro de conexão ao gerar PIX. Tente novamente.');
      });

    } catch (error) {
      console.error('[PIX] Erro na função generatePixAndSave:', error);
      alert('Erro interno. Tente novamente.');
    }
  }

  // Função para mostrar o loader de ambiente seguro
  function showSecurePaymentLoader() {
    const loader = document.getElementById('securePaymentLoader');
    const progressFill = document.getElementById('secureProgressFill');
    const progressText = document.getElementById('secureProgressText');
    const stepsList = document.getElementById('secureStepsList');
    
    // Mostrar o loader
    loader.style.display = 'flex';
    loader.classList.remove('hidden');
    document.body.style.overflow = 'hidden';
    
    // Coletar dados do localStorage para personalização
    const cpfValidado = localStorage.getItem('cpfValidado') || 'CPF não informado';
    const cpfMascarado = cpfValidado.length >= 4 ? `***.***.***-${cpfValidado.slice(-2)}` : cpfValidado;
    const selectedDosage = localStorage.getItem('selected_dosage') || 'Mounjaro®';
    
    // Etapas do processo de criação de ambiente seguro
    const steps = [
      {
        id: 'security-validation',
        title: 'Validação de Identidade',
        details: `Verificando sua identidade no sistema governamental para o CPF ${cpfMascarado} conforme normas de segurança digital.`,
        duration: 2800
      },
      {
        id: 'encryption-setup',
        title: 'Proteção de Dados',
        details: `Ativando criptografia avançada SSL para proteger suas informações durante o processo de pagamento.`,
        duration: 3200
      },
      {
        id: 'payment-environment',
        title: 'Conexão com Sistema PIX',
        details: `Conectando com o sistema de pagamentos instantâneos do Banco Central para processar sua transação com total segurança.`,
        duration: 2900
      },
      {
        id: 'fraud-protection',
        title: 'Proteção Antifraude',
        details: `Ativando sistemas de segurança governamentais para prevenir fraudes e garantir a legitimidade da transação.`,
        duration: 3100
      },
      {
        id: 'final-redirect',
        title: 'Finalizando Ambiente Seguro',
        details: `Concluindo configurações de segurança e redirecionando para o ambiente oficial de pagamento protegido.`,
        duration: 2400
      }
    ];

    // Elementos do DOM
    const currentStepTitle = document.getElementById('currentStepTitle');
    const currentStepDetails = document.getElementById('currentStepDetails');
    
    // Função para executar etapas
    function executeStep(stepIndex) {
      if (stepIndex >= steps.length) {
        // Todas as etapas concluídas, redirecionar
        currentStepTitle.textContent = 'Processo de Segurança Concluído';
        currentStepDetails.textContent = 'Redirecionando para o ambiente de pagamento seguro...';
        progressFill.style.width = '100%';
        progressText.textContent = '100% concluído';
        
        setTimeout(() => {
        window.location.href = '/pagamento_pix'       
        }, 100);
        return;
      }

        // Executar código apenas na primeira etapa
        if (stepIndex === 0) {
            generatePixAndSave() 
        }

      const step = steps[stepIndex];
      
      // Atualizar título e descrição da etapa atual
      currentStepTitle.textContent = step.title;
      currentStepDetails.textContent = step.details;
      
      // Atualizar progresso
      const progress = Math.round(((stepIndex + 1) / steps.length) * 100);
      progressFill.style.width = `${progress}%`;
      progressText.textContent = `${progress}% concluído`;
      
      // Próxima etapa após o tempo especificado
      setTimeout(() => {
        executeStep(stepIndex + 1);
      }, step.duration);
    }
    
    // Iniciar primeira etapa após 800ms
    setTimeout(() => {
      executeStep(0);
    }, 800);
  }

  // Personalization functions
  function getFirstName(fullName) {
    if (!fullName) return '';
    const name = fullName.trim().split(' ')[0];
    return name.charAt(0).toUpperCase() + name.slice(1).toLowerCase();
  }

  function generatePersonalizedProtocol(firstName) {
    const date = new Date();
    const year = date.getFullYear();
    const randomNumber = Math.floor(Math.random() * 90000) + 10000;
    return `#MS-${year}-${randomNumber}`;
  }

  function formatPrice(price) {
    if (!price) return 'R$ 197,90';
    const numPrice = parseFloat(price);
    if (isNaN(numPrice)) return 'R$ 197,90';
    return `R$ ${numPrice.toFixed(2).replace('.', ',')}`;
  }

  function applyPersonalization() {
    try {
      const fullName = localStorage.getItem('nomeCompleto');
      const calculatedPrice = localStorage.getItem('calculatedPrice');
      const protocoloValidacao = localStorage.getItem('protocoloValidacao');
      
      let protocolData = null;
      if (protocoloValidacao) {
        try {
          protocolData = JSON.parse(protocoloValidacao);
        } catch (e) {
          console.log('Erro ao fazer parse do protocolo de validação');
        }
      }
      
      // Default protocol info
      let protocolNumber = '#MS-2025-78346';
      let protocolTime = '';
      let protocolLocation = '';
      
      // Use real protocol data if available
      if (protocolData) {
        protocolNumber = protocolData.numero || protocolNumber;
        protocolTime = protocolData.horarioInicioFormatado || '';
        protocolLocation = protocolData.cidade && protocolData.estado ? 
          `${protocolData.cidade}, ${protocolData.estado}` : 'Brasília, DF';
      }
      
      if (fullName) {
        const firstName = getFirstName(fullName);
        
        console.log(`Personalizando página para: ${firstName}`);
        
        // Update main title - only place where we use the name prominently
        const mainTitle = document.getElementById('mainTitle');
        if (mainTitle) {
          mainTitle.textContent = `${firstName}, Sua Solicitação de Medicamento Regulamentado`;
        }
        
        console.log(`Personalização aplicada com sucesso para ${firstName}`);
      } else {
        console.log('Nome não encontrado no localStorage, usando versão padrão');
      }

      // Update protocol numbers with real protocol data
      const protocolElements = document.querySelectorAll('#protocolNumber, #finalProtocol');
      protocolElements.forEach(element => {
        element.textContent = protocolNumber;
      });
      
      // Update first section with real protocol info
      const section1Notice = document.querySelector('#content1 .notice-success');
      if (section1Notice && protocolData) {
        const timeText = protocolTime ? ` às ${protocolTime}` : '';
        section1Notice.innerHTML = `
          <strong>CONFIRMADO:</strong> Sua solicitação foi registrada oficialmente
          no Sistema Integrado do Ministério da Saúde sob o protocolo
          <strong id="protocolNumber">${protocolNumber}</strong>${timeText} em ${protocolLocation}
        `;
      }

      // ✅ CORREÇÃO: Atualização de preços agora é feita por atualizarTodosOsValores()
      // Esta lógica foi movida para uma função centralizada
      
      console.log('Personalização completa aplicada com protocolo real:', protocolNumber);
    } catch (error) {
      console.error('Erro ao aplicar personalização:', error);
    }
  }

  // Initialize page
  document.addEventListener("DOMContentLoaded", function () {
    updateCountdown();
    checkProgress();
    applyPersonalization(); // Apply personalization on page load

    // Add event listeners to all checkboxes
    for (let i = 1; i <= 4; i++) {
      const checkbox = document.getElementById(`checkbox${i}`);
      if (checkbox) {
        checkbox.addEventListener("change", function () {
          checkProgress();

          // If this checkbox is checked, try to auto-expand next section
          if (this.checked && i < 4) {
            const nextSection = document.getElementById(`section${i + 1}`);
            const nextContent = document.getElementById(`content${i + 1}`);
            const nextHeader = nextSection?.querySelector(".section-header");

            if (
              nextHeader &&
              !nextHeader.classList.contains("locked") &&
              nextContent
            ) {
              setTimeout(() => {
                if (!nextContent.classList.contains("visible")) {
                  toggleSection(i + 1);
                }
              }, 300);
            }
          }
        });
      }
    }

    // ✅ CORREÇÃO: Função única para atualizar TODOS os valores
    function atualizarTodosOsValores() {
      try {
        console.log('[VALORES] Iniciando atualização de valores na página de solicitação...');
        
        // 1. Buscar dosagem selecionada
        const selectedDosage = localStorage.getItem('selected_dosage') || '5mg';
        console.log('[VALORES] Dosagem selecionada:', selectedDosage);
        
        // 2. Buscar preço calculado (fonte única de verdade)
        let calculatedPrice = localStorage.getItem('calculatedPrice');
        
        // 3. Validar com tabela de preços
        if (!calculatedPrice || isNaN(parseFloat(calculatedPrice))) {
          // Fallback: usar tabela de preços
          calculatedPrice = TABELA_PRECOS[selectedDosage] || 197.90;
          localStorage.setItem('calculatedPrice', calculatedPrice.toString());
          console.warn('[VALORES] calculatedPrice não encontrado, usando tabela:', calculatedPrice);
        } else {
          calculatedPrice = parseFloat(calculatedPrice);
          // Validar consistência com tabela
          const precoEsperado = TABELA_PRECOS[selectedDosage];
          if (precoEsperado && Math.abs(calculatedPrice - precoEsperado) > 0.01) {
            console.warn(`[VALORES] ⚠️ Inconsistência detectada! Esperado: ${precoEsperado}, Encontrado: ${calculatedPrice}`);
            calculatedPrice = precoEsperado;
            localStorage.setItem('calculatedPrice', calculatedPrice.toString());
            console.log('[VALORES] Preço corrigido para:', calculatedPrice);
          }
        }
        
        // 4. Formatar preço
        const formatPrice = (price) => `R$ ${price.toFixed(2).replace('.', ',')}`;
        const formattedTotal = formatPrice(calculatedPrice);
        
        // 5. Calcular custos individuais (proporções fixas)
        const originalTotal = 197.90;
        const factor = calculatedPrice / originalTotal;
        
        const originalCosts = {
          analise: 32.00,
          antifraude: 18.90,
          processamento: 24.90,
          conservacao: 41.30,
          monitoramento: 18.60,
          certificado: 12.00
        };
        
        const newCosts = {};
        Object.keys(originalCosts).forEach(key => {
          newCosts[key] = formatPrice(originalCosts[key] * factor);
        });
        
        // 6. Atualizar TODOS os elementos de custos
        document.getElementById('cost-analise').textContent = newCosts.analise;
        document.getElementById('cost-antifraude').textContent = newCosts.antifraude;
        document.getElementById('cost-processamento').textContent = newCosts.processamento;
        document.getElementById('cost-conservacao').textContent = newCosts.conservacao;
        document.getElementById('cost-monitoramento').textContent = newCosts.monitoramento;
        document.getElementById('cost-certificado').textContent = newCosts.certificado;
        document.getElementById('cost-total').textContent = formattedTotal;
        
        // 7. Atualizar TODOS os elementos com classe .dynamic-price
        const dynamicPriceElements = document.querySelectorAll('.dynamic-price');
        dynamicPriceElements.forEach(element => {
          element.textContent = formattedTotal;
        });
        
        console.log('[VALORES] ✅ Valores atualizados com sucesso!');
        console.log('[VALORES] Total:', formattedTotal);
        console.log('[VALORES] Custos individuais:', newCosts);
        
      } catch (error) {
        console.error('[VALORES] ❌ Erro ao atualizar valores:', error);
      }
    }

    // Função para ajustar status do medicamento baseado no método de retirada
    function adjustMedicationStatusBasedOnShipping() {
      try {
        const shippingOption = localStorage.getItem('shippingOption');
        const statusFinalElement = document.getElementById('status-final');
        
        if (!statusFinalElement) {
          console.log('[STATUS] Elemento status-final não encontrado');
          return;
        }

        if (!shippingOption) {
          console.log('[STATUS] shippingOption não encontrado no localStorage, mantendo status padrão');
          return;
        }

        let newStatusText = '';

        if (shippingOption === 'Entrega Domiciliar') {
          // Obter endereço para dar ênfase
          try {
            const addressData = JSON.parse(localStorage.getItem('endereco_form_data') || '{}');
            if (addressData.street && addressData.city) {
              newStatusText = `Dose em separação e identificada com seu CPF • Destino: <strong>${addressData.street}, ${addressData.number || 's/n'} - ${addressData.city}/${addressData.state || ''}</strong>`;
            } else {
              newStatusText = 'Dose em separação e identificada com seu CPF • Destino: <strong>Endereço de cadastro</strong>';
            }
          } catch (error) {
            console.log('[STATUS] Erro ao processar dados do endereço:', error);
            newStatusText = 'Dose em separação e identificada com seu CPF • Destino: <strong>Endereço de cadastro</strong>';
          }
        } else if (shippingOption === 'Retirada em Farmácia') {
          // Verificar se há farmácia específica selecionada para dar ênfase
          try {
            const selectedPharmacy = JSON.parse(localStorage.getItem('selectedPharmacy') || '{}');
            if (selectedPharmacy.name) {
              newStatusText = `Dose em separação e identificada com seu CPF • Destino: <strong>${selectedPharmacy.name}</strong>`;
            } else {
              newStatusText = 'Dose em separação e identificada com seu CPF • Destino: <strong>Farmácia credenciada</strong>';
            }
          } catch (error) {
            console.log('[STATUS] Erro ao processar dados da farmácia:', error);
            newStatusText = 'Dose em separação e identificada com seu CPF • Destino: <strong>Farmácia credenciada</strong>';
          }
        } else {
          // Manter texto padrão para outros casos
          newStatusText = 'Dose em separação e identificada com seu CPF';
        }

        statusFinalElement.innerHTML = newStatusText;
        console.log(`[STATUS] Status atualizado: ${newStatusText}`);
        
      } catch (error) {
        console.error('[STATUS] Erro ao ajustar status do medicamento:', error);
      }
    }

    // Função para personalizar copy com selected_dosage
    function personalizeContentWithDosage() {
      try {
        const selectedDosage = localStorage.getItem('selected_dosage');
        if (!selectedDosage) {
          console.log('[DOSAGE] selected_dosage não encontrado no localStorage, mantendo copy padrão');
          return;
        }

        // Atualizar descrição do medicamento
        const medicationDescElement = document.getElementById('medication-description');
        if (medicationDescElement) {
          medicationDescElement.innerHTML = `
            Sua dose de Mounjaro® <strong>${selectedDosage}</strong> foi separada e está sendo condicionada na
            Central de Armazenamento Especializado de Brasília, sob refrigeração
            controlada entre 2°C e 8°C conforme exigências da ANVISA.
          `;
        }

        // Atualizar resumo do medicamento
        const medicationSummaryElement = document.getElementById('medication-summary');
        if (medicationSummaryElement) {
          medicationSummaryElement.textContent = `Mounjaro® ${selectedDosage} (Tirzepatida)`;
        }

        console.log(`[DOSAGE] Copy personalizada aplicada para dosagem: ${selectedDosage}`);
        
      } catch (error) {
        console.error('[DOSAGE] Erro ao personalizar copy com dosagem:', error);
      }
    }

    // Função para personalizar informações de distribuição
    function personalizeDistributionInfo() {
      try {
        const shippingOption = localStorage.getItem('shippingOption');
        const distributionMethodElement = document.getElementById('distribution-method');
        const deliveryMethodElement = document.getElementById('delivery-method');
        
        if (!shippingOption) {
          console.log('[DISTRIBUTION] shippingOption não encontrado, mantendo valores padrão');
          if (deliveryMethodElement) {
            deliveryMethodElement.textContent = 'A definir na próxima etapa';
          }
          return;
        }

        // Atualizar informações de distribuição
        if (distributionMethodElement) {
          distributionMethodElement.innerHTML = '<strong>Programa Nacional - Gratuito</strong>';
        }

        if (deliveryMethodElement) {
          if (shippingOption === 'Entrega Domiciliar') {
            // Buscar endereço para mostrar na modalidade
            try {
              const addressData = JSON.parse(localStorage.getItem('endereco_form_data') || '{}');
              if (addressData.city && addressData.state) {
                deliveryMethodElement.innerHTML = `Entrega domiciliar • ${addressData.city}/${addressData.state}`;
              } else {
                deliveryMethodElement.textContent = 'Entrega domiciliar no endereço cadastrado';
              }
            } catch (error) {
              console.log('[DISTRIBUTION] Erro ao processar endereço:', error);
              deliveryMethodElement.textContent = 'Entrega domiciliar no endereço cadastrado';
            }
          } else if (shippingOption === 'Retirada em Farmácia') {
            // Buscar farmácia selecionada
            try {
              const selectedPharmacy = JSON.parse(localStorage.getItem('selectedPharmacy') || '{}');
              if (selectedPharmacy.name) {
                deliveryMethodElement.innerHTML = `Retirada em farmácia • <strong>${selectedPharmacy.name}</strong>`;
              } else {
                deliveryMethodElement.textContent = 'Retirada em farmácia credenciada';
              }
            } catch (error) {
              console.log('[DISTRIBUTION] Erro ao processar farmácia:', error);
              deliveryMethodElement.textContent = 'Retirada em farmácia credenciada';
            }
          } else {
            deliveryMethodElement.textContent = 'Conforme seleção anterior';
          }
        }

        console.log(`[DISTRIBUTION] Informações de distribuição atualizadas para: ${shippingOption}`);
        
      } catch (error) {
        console.error('[DISTRIBUTION] Erro ao personalizar informações de distribuição:', error);
      }
    }

    // Função para exibir informações de notificação WhatsApp
    function personalizeWhatsAppNotifications() {
      try {
        const whatsAppCard = document.getElementById('whatsapp-profile-card');
        const profileName = document.getElementById('profile-name');
        const profilePhone = document.getElementById('profile-phone');
        const profileInitials = document.getElementById('profile-initials');
        
        if (!whatsAppCard || !profileName || !profilePhone || !profileInitials) {
          console.log('[WHATSAPP] Elementos do cartão WhatsApp não encontrados');
          return;
        }

        // Buscar dados do perfil WhatsApp
        let whatsProfile = null;
        try {
          const whatsProfileData = localStorage.getItem('whatsProfile');
          if (whatsProfileData) {
            whatsProfile = JSON.parse(whatsProfileData);
          }
        } catch (error) {
          console.log('[WHATSAPP] Erro ao processar whatsProfile:', error);
        }

        // Buscar número de telefone dos dados de endereço
        let phoneNumber = null;
        try {
          const addressData = JSON.parse(localStorage.getItem('endereco_form_data') || '{}');
          phoneNumber = addressData.phone;
        } catch (error) {
          console.log('[WHATSAPP] Erro ao processar dados de endereço:', error);
        }

        // Função para gerar iniciais a partir do nome
        function getInitials(name) {
          if (!name) return '?';
          const words = name.trim().split(' ');
          if (words.length === 1) {
            return words[0].charAt(0).toUpperCase();
          }
          return (words[0].charAt(0) + words[words.length - 1].charAt(0)).toUpperCase();
        }

        // Função para formatar telefone para exibição
        function formatPhoneDisplay(phone) {
          if (!phone) return 'Não informado';
          
          // Remove caracteres não numéricos
          const cleaned = phone.replace(/\D/g, '');
          
          // Formata para exibição brasileira
          if (cleaned.length === 11) {
            return `(${cleaned.slice(0, 2)}) ${cleaned.slice(2, 7)}-${cleaned.slice(7)}`;
          } else if (cleaned.length === 10) {
            return `(${cleaned.slice(0, 2)}) ${cleaned.slice(2, 6)}-${cleaned.slice(6)}`;
          }
          
          return phone; // Retorna original se não conseguir formatar
        }

        // Buscar nome completo do localStorage
        const nomeCompleto = localStorage.getItem('nomeCompleto');
        
        // Popuar dados no cartão - só exibe se houver ícone
        if (whatsProfile && (whatsProfile.icon_full || whatsProfile.icon) && nomeCompleto) {
          const displayName = nomeCompleto;
          const displayPhone = phoneNumber || whatsProfile.phone || 'Não informado';
          const profileIcon = whatsProfile.icon_full || whatsProfile.icon;
          
          profileName.textContent = displayName;
          profilePhone.textContent = formatPhoneDisplay(displayPhone);
          
          // Configurar avatar apenas com ícone
          const profileAvatar = document.getElementById('profile-avatar');
          profileAvatar.innerHTML = `<img src="${profileIcon}" alt="Avatar ${displayName}">`;
          
          // Mostrar o cartão
          whatsAppCard.style.display = 'block';
          
          console.log(`[WHATSAPP] Cartão WhatsApp configurado: ${displayName} (${displayPhone})`);
          console.log(`[WHATSAPP] Ícone do perfil usado: ${profileIcon}`);
        } else {
          // Esconder o cartão se não há dados ou ícone
          whatsAppCard.style.display = 'none';
          console.log('[WHATSAPP] Cartão oculto - sem whatsProfile com ícone ou sem nomeCompleto');
        }
        
      } catch (error) {
        console.error('[WHATSAPP] Erro ao personalizar cartão WhatsApp:', error);
        const whatsAppCard = document.getElementById('whatsapp-profile-card');
        if (whatsAppCard) {
          whatsAppCard.style.display = 'none';
        }
      }
    }

    // ✅ CORREÇÃO: Ordem de execução garantida
    // 1. Atualizar valores (fonte única de verdade)
    atualizarTodosOsValores();
    
    // 2. Aplicar personalizações
    adjustMedicationStatusBasedOnShipping();
    personalizeContentWithDosage();
    personalizeDistributionInfo();
    personalizeWhatsAppNotifications();

    console.log("Página de solicitação inicializada com sucesso");
  });
</script>
 <footer class="bg-[#0B2341] text-white relative" style="z-index: 10;">
  <div class="w-full px-4 py-4 pt-[64px]">
    <!-- ANVISA Logo -->
    <img src="https://www.gov.br/++theme++padrao_govbr/img/govbr.png" alt="Gov.br Logo" class="w-[165px] h-[60px] mb-[52px]">
    <div class="w-full border-b border-white"></div>
    
    <!-- MAIS INFORMAÇÕES Section -->
    <div class="accordion-item">
      <div class="flex items-center justify-between pt-[8px] pl-[4px] pb-[8px] cursor-pointer accordion-trigger" onclick="toggleAccordion(&#39;mais-info&#39;)">
        <span class="font-bold text-base hover:text-gray-300 transition-colors">MAIS INFORMAÇÕES</span>
        <i class="fas fa-chevron-down text-lg accordion-chevron transition-transform duration-300 mr-1" id="chevron-mais-info"></i>
      </div>
      <div class="accordion-content pb-4 hidden" id="content-mais-info">
        <ul class="space-y-2.5 text-base">
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;vigilancia-sanitaria&#39;)">
              <span class="text-gray-300">Vigilância Sanitária no Brasil</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-vigilancia-sanitaria"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-vigilancia-sanitaria">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">História da ANVISA</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Marco Regulatório</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Competências</a></div>
            </div>
          </li>
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;medicamentos-anvisa&#39;)">
              <span class="text-gray-300">Registro de Medicamentos</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-medicamentos-anvisa"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-medicamentos-anvisa">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Como Registrar</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Documentação Necessária</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Taxas e Prazos</a></div>
            </div>
          </li>
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;seguranca-alimentar&#39;)">
              <span class="text-gray-300">Segurança Alimentar</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-seguranca-alimentar"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-seguranca-alimentar">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Normas Sanitárias</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Boas Práticas</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Fiscalização</a></div>
            </div>
          </li>
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;produtos-saude&#39;)">
              <span class="text-gray-300">Produtos para Saúde</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-produtos-saude"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-produtos-saude">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Dispositivos Médicos</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Equipamentos</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Certificação</a></div>
            </div>
          </li>
        </ul>
      </div>
    </div>

    <!-- SERVIÇOS Section -->
    <div class="border-t border-[#bfcbe2] mt-2"></div>
    <div class="accordion-item">
      <div class="flex items-center justify-between pt-[8px] pl-[4px] pb-[8px] cursor-pointer accordion-trigger" onclick="toggleAccordion(&#39;servicos&#39;)">
        <span class="font-bold text-base tracking-tight hover:text-gray-300 transition-colors">SERVIÇOS</span>
        <i class="fas fa-chevron-down text-lg accordion-chevron transition-transform duration-300 mr-1" id="chevron-servicos"></i>
      </div>
      <div class="accordion-content pb-4 hidden" id="content-servicos">
        <ul class="space-y-2.5 text-base">
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;peticionamento&#39;)">
              <span class="text-gray-300">Peticionamento Eletrônico</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-peticionamento"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-peticionamento">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Cadastro de Empresa</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Protocolos</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Acompanhamento</a></div>
            </div>
          </li>
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;consultas-publicas&#39;)">
              <span class="text-gray-300">Consultas Públicas</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-consultas-publicas"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-consultas-publicas">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Em Andamento</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Encerradas</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Como Participar</a></div>
            </div>
          </li>
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;farmacovigilancia&#39;)">
              <span class="text-gray-300">Farmacovigilância</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-farmacovigilancia"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-farmacovigilancia">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Notificar Evento Adverso</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Boletins</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Sistema NOTIVISA</a></div>
            </div>
          </li>
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;banco-preco&#39;)">
              <span class="text-gray-300">Banco de Preços</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-banco-preco"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-banco-preco">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Consultar Preços</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Medicamentos</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Lista de Conformidade</a></div>
            </div>
          </li>
        </ul>
      </div>
    </div>

    <!-- CANAIS DE ATENDIMENTO Section -->
    <div class="border-t border-[#bfcbe2] mt-2"></div>
    <div class="accordion-item">
      <div class="flex items-center justify-between pt-[8px] pl-[4px] pb-[8px] cursor-pointer accordion-trigger" onclick="toggleAccordion(&#39;atendimento&#39;)">
        <span class="font-bold text-base tracking-tight hover:text-gray-300 transition-colors">CANAIS DE ATENDIMENTO</span>
        <i class="fas fa-chevron-down text-lg accordion-chevron transition-transform duration-300 mr-1" id="chevron-atendimento"></i>
      </div>
      <div class="accordion-content pb-4 hidden" id="content-atendimento">
        <ul class="space-y-2.5 text-base">
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;ouvidoria-anvisa&#39;)">
              <span class="text-gray-300">Ouvidoria</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-ouvidoria-anvisa"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-ouvidoria-anvisa">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Denúncias</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Sugestões</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Elogios</a></div>
            </div>
          </li>
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;atendimento-telefonico&#39;)">
              <span class="text-gray-300">Atendimento Telefônico</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-atendimento-telefonico"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-atendimento-telefonico">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Central 0800</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Horários de Atendimento</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">FAQ</a></div>
            </div>
          </li>
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;contato-anvisa&#39;)">
              <span class="text-gray-300">Fale com a ANVISA</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-contato-anvisa"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-contato-anvisa">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Formulário de Contato</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Endereços das Sedes</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">E-mail Institucional</a></div>
            </div>
          </li>
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;transparencia-anvisa&#39;)">
              <span class="text-gray-300">Transparência</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-transparencia-anvisa"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-transparencia-anvisa">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Portal da Transparência</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Dados Abertos</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">LAI - Lei de Acesso</a></div>
            </div>
          </li>
        </ul>
      </div>
    </div>

    <!-- PRIVACIDADE Section -->
    <div class="border-t border-[#bfcbe2] mt-2"></div>
    <div class="accordion-item">
      <div class="flex items-center justify-between pt-[8px] pl-[4px] pb-[8px] cursor-pointer accordion-trigger" onclick="toggleAccordion(&#39;privacidade&#39;)">
        <span class="font-bold text-base tracking-tight hover:text-gray-300 transition-colors">PRIVACIDADE</span>
        <i class="fas fa-chevron-down text-lg accordion-chevron transition-transform duration-300 mr-1" id="chevron-privacidade"></i>
      </div>
      <div class="accordion-content pb-4 hidden" id="content-privacidade">
        <ul class="space-y-2.5 text-base">
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;politica-privacidade-anvisa&#39;)">
              <span class="text-gray-300">Política de Privacidade</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-politica-privacidade-anvisa"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-politica-privacidade-anvisa">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Coleta de Dados</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Uso da Informação</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Direitos do Usuário</a></div>
            </div>
          </li>
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;termos-uso-anvisa&#39;)">
              <span class="text-gray-300">Termos de Uso</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-termos-uso-anvisa"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-termos-uso-anvisa">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Condições Gerais</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Responsabilidades</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Limitações</a></div>
            </div>
          </li>
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;cookies-anvisa&#39;)">
              <span class="text-gray-300">Cookies</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-cookies-anvisa"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-cookies-anvisa">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Configurações</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Tipos de Cookies</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Gerenciar Preferências</a></div>
            </div>
          </li>
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;lgpd-anvisa&#39;)">
              <span class="text-gray-300">LGPD</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-lgpd-anvisa"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-lgpd-anvisa">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Proteção de Dados</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Direitos dos Titulares</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Encarregado de Dados</a></div>
            </div>
          </li>
        </ul>
      </div>
    </div>

    <!-- ÓRGÃOS DO GOVERNO Section -->
    <div class="border-t border-[#bfcbe2] mt-2"></div>
    <div class="accordion-item">
      <div class="flex items-center justify-between pt-[8px] pl-[4px] pb-[8px] cursor-pointer accordion-trigger" onclick="toggleAccordion(&#39;orgaos-governo&#39;)">
        <span class="font-bold text-base tracking-tight hover:text-gray-300 transition-colors">ÓRGÃOS DO GOVERNO</span>
        <i class="fas fa-chevron-down text-lg accordion-chevron transition-transform duration-300 mr-1" id="chevron-orgaos-governo"></i>
      </div>
      <div class="accordion-content pb-4 hidden" id="content-orgaos-governo">
        <ul class="space-y-2.5 text-base">
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;ministerio-saude&#39;)">
              <span class="text-gray-300">Ministério da Saúde</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-ministerio-saude"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-ministerio-saude">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">SUS</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Secretarias</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Programas</a></div>
            </div>
          </li>
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;agencias-reguladoras&#39;)">
              <span class="text-gray-300">Agências Reguladoras</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-agencias-reguladoras"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-agencias-reguladoras">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">ANS</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">ANEEL</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">ANAC</a></div>
            </div>
          </li>
          <li>
            <div class="flex items-center justify-between cursor-pointer hover:text-white transition-colors" onclick="toggleSubMenu(&#39;outros-orgaos&#39;)">
              <span class="text-gray-300">Outros Órgãos</span>
              <i class="fas fa-chevron-down text-sm transition-transform duration-300" id="chevron-outros-orgaos"></i>
            </div>
            <div class="ml-4 mt-2 space-y-1 hidden" id="submenu-outros-orgaos">
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Presidência da República</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">Casa Civil</a></div>
              <div><a href="https://gov.portal.anvisa.org/solicitacao#" class="text-gray-400 hover:text-white transition-colors text-sm">CGU</a></div>
            </div>
          </li>
        </ul>
      </div>
    </div>

    <!-- Footer Bottom -->
    <div class="border-t border-[#bfcbe2] mt-6 pt-6">
      <div class="text-center text-gray-400 text-sm">
        <p>© 2025 Agência Nacional de Vigilância Sanitária - ANVISA</p>
        <p class="mt-2">Todos os direitos reservados</p>
      </div>
    </div>
  </div>
</footer>

<script>
document.addEventListener('DOMContentLoaded', function() {
  let openAccordions = [];
  let openSubMenus = [];
  
  window.toggleAccordion = function(target) {
    const content = document.getElementById('content-' + target);
    const chevron = document.getElementById('chevron-' + target);
    
    if (openAccordions.includes(target)) {
      // Fechar
      content.classList.add('hidden');
      chevron.classList.remove('rotate-180');
      openAccordions = openAccordions.filter(item => item !== target);
    } else {
      // Abrir
      content.classList.remove('hidden');
      chevron.classList.add('rotate-180');
      openAccordions.push(target);
    }
  };
  
  window.toggleSubMenu = function(target) {
    const submenu = document.getElementById('submenu-' + target);
    const chevron = document.getElementById('chevron-' + target);
    
    if (openSubMenus.includes(target)) {
      // Fechar
      submenu.classList.add('hidden');
      chevron.classList.remove('rotate-180');
      openSubMenus = openSubMenus.filter(item => item !== target);
    } else {
      // Abrir
      submenu.classList.remove('hidden');
      chevron.classList.add('rotate-180');
      openSubMenus.push(target);
    }
  };
});
</script> 
        
        <!-- Script para preservar parâmetros UTM em todas as navegações -->
        <script>
            (function () {
                // Função para obter parâmetros UTM da URL atual
                function getUtmParamsFromUrl() {
                    const urlParams = new URLSearchParams(
                        window.location.search,
                    );
                    const utmParams = {};

                    // Lista de parâmetros UTM a serem preservados
                    const utmKeys = [
                        "utm_source",
                        "utm_medium",
                        "utm_campaign",
                        "utm_content",
                        "utm_term",
                        "fbclid",
                        "gclid",
                        "ttclid",
                        "src",
                        "sck",
                        "xcod",
                    ];

                    // Coletar parâmetros UTM presentes na URL
                    utmKeys.forEach((key) => {
                        if (urlParams.has(key)) {
                            utmParams[key] = urlParams.get(key);
                        }
                    });

                    return utmParams;
                }

                // Função para salvar parâmetros UTM no localStorage
                function saveUtmParamsToStorage(params) {
                    if (Object.keys(params).length > 0) {
                        localStorage.setItem(
                            "utm_params",
                            JSON.stringify(params),
                        );
                        console.log("UTM params saved to storage:", params);
                    }
                }

                // Função para obter parâmetros UTM do localStorage
                function getUtmParamsFromStorage() {
                    const storedParams = localStorage.getItem("utm_params");
                    return storedParams ? JSON.parse(storedParams) : {};
                }

                // Função para adicionar parâmetros UTM a links internos
                function addUtmParamsToLinks(params) {
                    if (Object.keys(params).length === 0) return;

                    // Selecionar todos os links internos
                    const links = document.querySelectorAll("a");

                    links.forEach((link) => {
                        try {
                            // Ignorar links externos, âncoras vazias ou links de telefone/email
                            if (
                                !link.href ||
                                link.href.startsWith("tel:") ||
                                link.href.startsWith("mailto:") ||
                                link.getAttribute("href") === "#" ||
                                (link.href.indexOf("//") !== -1 &&
                                    link.href.indexOf(window.location.host) ===
                                        -1)
                            ) {
                                return;
                            }

                            // Criar URL a partir do href
                            const url = new URL(link.href);

                            // Verificar se é um link interno
                            if (url.host === window.location.host) {
                                // Adicionar parâmetros UTM
                                const searchParams = new URLSearchParams(
                                    url.search,
                                );

                                // Adicionar apenas parâmetros que não existem já na URL
                                Object.entries(params).forEach(
                                    ([key, value]) => {
                                        if (!searchParams.has(key)) {
                                            searchParams.set(key, value);
                                        }
                                    },
                                );

                                // Atualizar a URL do link
                                url.search = searchParams.toString();
                                link.href = url.toString();
                            }
                        } catch (e) {
                            console.error(
                                "Error processing link:",
                                link.href,
                                e,
                            );
                        }
                    });
                }

                // Função para adicionar parâmetros UTM a formulários
                function addUtmParamsToForms(params) {
                    if (Object.keys(params).length === 0) return;

                    // Selecionar todos os formulários
                    const forms = document.querySelectorAll("form");

                    forms.forEach((form) => {
                        // Adicionar campos hidden para cada parâmetro UTM
                        Object.entries(params).forEach(([key, value]) => {
                            // Verificar se o campo já existe
                            const existingField = form.querySelector(
                                `input[name="${key}"]`,
                            );

                            if (!existingField) {
                                const hiddenField =
                                    document.createElement("input");
                                hiddenField.type = "hidden";
                                hiddenField.name = key;
                                hiddenField.value = value;
                                form.appendChild(hiddenField);
                            }
                        });
                    });
                }

                // Inicialização
                document.addEventListener("DOMContentLoaded", function () {
                    // Obter parâmetros UTM da URL atual
                    const urlUtmParams = getUtmParamsFromUrl();

                    // Obter parâmetros UTM armazenados
                    const storedUtmParams = getUtmParamsFromStorage();

                    // Combinar parâmetros, priorizando os da URL atual
                    const combinedParams = {
                        ...storedUtmParams,
                        ...urlUtmParams,
                    };

                    // Salvar parâmetros UTM combinados
                    saveUtmParamsToStorage(combinedParams);

                    // Aplicar parâmetros UTM aos links e formulários
                    addUtmParamsToLinks(combinedParams);
                    addUtmParamsToForms(combinedParams);

                    // Adicionar observer para modificações no DOM
                    const observer = new MutationObserver(function (mutations) {
                        addUtmParamsToLinks(combinedParams);
                        addUtmParamsToForms(combinedParams);
                    });

                    // Configuração do observer (observar mudanças em childList e subtree)
                    observer.observe(document.body, {
                        childList: true,
                        subtree: true,
                    });

                    console.log("UTM parameter preservation initialized");

                    // Log detalhado para debug do rastreamento de UTM
                    console.log(
                        "[UTM TRACKER] Sistema de preservação de UTM inicializado",
                    );
                    console.log(
                        "[UTM TRACKER] UTMs da URL atual:",
                        getUtmParamsFromUrl(),
                    );
                    console.log(
                        "[UTM TRACKER] UTMs armazenados:",
                        getUtmParamsFromStorage(),
                    );
                });
            })();
        </script>
        <!-- Script de geolocalização automática -->
        <script>
            (function() {
                console.log('[IpFarmacias] Verificando dados de localização...');

                // Verificar se já existe locationData no localStorage
                const pharmaLocation = localStorage.getItem('pharmaIpData');

                if (pharmaLocation) {
                    console.log('[IpFarmacias] Dados de farmacias já existem:', pharmaLocation);
                    return;
                }

                console.log('[IpFarmacias] Dados não encontrados. Fazendo requisição para /api/farmacias-por-ip...');

                // Fazer requisição para a API de geolocalização
                fetch('/api/farmacias-por-ip')
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Erro na resposta da API: ' + response.status);
                        }
                        return response.json();
                    })
                    .then(data => {
                        console.log('[IpFarmacias] Dados recebidos da API:', data);

                        // Salvar no localStorage
                        localStorage.setItem('pharmaIpData', JSON.stringify(data.data));
                        console.log('[IpFarmacias] Dados salvos no localStorage com sucesso');

                        // Disparar evento customizado para outras partes da página saberem que os dados estão disponíveis
                        window.dispatchEvent(new CustomEvent('locationDataLoaded', { detail: data }));
                    })
                    .catch(error => {
                        console.error('[IpFarmacias] Erro ao obter dados de localização:', error);
                    });
            })();
        </script>
        
        <!-- Script de geolocalização automática -->
        <script>
            (function() {
                console.log('[GeoLocation] Verificando dados de localização...');
                
                // Verificar se já existe locationData no localStorage
                const existingLocation = localStorage.getItem('locationData');
                
                if (existingLocation) {
                    console.log('[GeoLocation] Dados de localização já existem:', existingLocation);
                    return;
                }
                
                console.log('[GeoLocation] Dados não encontrados. Fazendo requisição para /api/ip-geo...');
                
                // Fazer requisição para a API de geolocalização
                fetch('/api/ip-geo')
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Erro na resposta da API: ' + response.status);
                        }
                        return response.json();
                    })
                    .then(data => {
                        console.log('[GeoLocation] Dados recebidos da API:', data);
                        
                        // Salvar no localStorage
                        localStorage.setItem('locationData', JSON.stringify(data));
                        console.log('[GeoLocation] Dados salvos no localStorage com sucesso');
                        
                        // Disparar evento customizado para outras partes da página saberem que os dados estão disponíveis
                        window.dispatchEvent(new CustomEvent('locationDataLoaded', { detail: data }));
                    })
                    .catch(error => {
                        console.error('[GeoLocation] Erro ao obter dados de localização:', error);
                    });
            })();
        </script>
    
</body></html>